{
  "admin": {
    "disabled": false,
    "listen": "0.0.0.0:2019"
  },
  "logging": {
    "logs": {
      "default": {
        "level": "INFO"
      }
    }
  },
  "storage": {
    "module": "file_system",
    "root": "/data"
  },
  "apps": {
    "http": {
      "servers": {
        "srv0": {
          "listen": [":80", ":443"],
          "routes": [
            {
              "match": [{ "path": ["/health"] }],
              "handle": [
                {
                  "handler": "static_response",
                  "status_code": 200,
                  "body": "ok"
                }
              ]
            },
            {
              "match": [{ "host": ["api.giraffecloud.xyz"] }],
              "handle": [
                {
                  "handler": "headers",
                  "response": {
                    "set": {
                      "Strict-Transport-Security": [
                        "max-age=31536000; includeSubDomains; preload"
                      ],
                      "X-Content-Type-Options": ["nosniff"],
                      "Access-Control-Allow-Origin": [
                        "https://giraffecloud.xyz"
                      ],
                      "Access-Control-Allow-Methods": [
                        "GET, POST, PUT, DELETE, OPTIONS"
                      ],
                      "Access-Control-Allow-Headers": [
                        "Content-Type, Authorization, X-Requested-With, X-CSRF-Token, Origin, X-Vercel-Id"
                      ],
                      "Access-Control-Allow-Credentials": ["true"],
                      "Access-Control-Max-Age": ["3600"],
                      "Access-Control-Expose-Headers": ["*"]
                    },
                    "delete": ["Server"]
                  }
                },
                {
                  "handler": "subroute",
                  "routes": [
                    {
                      "match": [{ "method": ["OPTIONS"] }],
                      "handle": [
                        {
                          "handler": "static_response",
                          "status_code": 204
                        }
                      ]
                    },
                    {
                      "handle": [
                        {
                          "handler": "reverse_proxy",
                          "transport": {
                            "protocol": "http"
                          },
                          "upstreams": [
                            {
                              "dial": "api:8080"
                            }
                          ],
                          "headers": {
                            "request": {
                              "set": {
                                "Host": ["{http.request.host}"],
                                "X-Real-IP": ["{http.request.remote.host}"],
                                "X-Forwarded-For": [
                                  "{http.request.remote.host}"
                                ],
                                "X-Forwarded-Proto": ["{http.request.scheme}"],
                                "Origin": ["https://giraffecloud.xyz"],
                                "Referer": ["{http.request.header.Referer}"],
                                "Authorization": [
                                  "{http.request.header.Authorization}"
                                ],
                                "X-Vercel-Id": [
                                  "{http.request.header.X-Vercel-Id}"
                                ]
                              }
                            }
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "handle": [
                {
                  "handler": "static_response",
                  "status_code": 404,
                  "body": "Not Found"
                }
              ]
            }
          ],
          "automatic_https": {
            "disable": false,
            "skip": [],
            "skip_certificates": [],
            "disable_redirects": false
          },
          "logs": {
            "default_logger_name": "default"
          },
          "errors": {
            "routes": [
              {
                "handle": [
                  {
                    "handler": "static_response",
                    "body": "{http.error.status_code} {http.error.status_text}",
                    "status_code": "{http.error.status_code}"
                  }
                ]
              }
            ]
          }
        }
      }
    }
  }
}
